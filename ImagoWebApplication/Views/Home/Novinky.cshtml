@{
    ViewData["Title"] = "Novinky";
}

<style>
    .news-list img {
        width: 100px;
        height: 100px;
    }

    .news-list a {
        background-color: #1d4f99;
        font-size: 16px;
    }
</style>

<section id="content" class="py-5">
    <div class="container" style="width:1100px;">
        <h1 class="page-title" style="margin-bottom:30px; text-align:center;">Novinky</h1>

        <form action="/cs/news/" method="post" id="frm-periodForm" class="d-none">
            <input type="hidden" name="period" id="frm-periodForm-period" value="">
            <input type="hidden" name="do" value="periodForm-submit">
        </form>

        <div class="row">
            <div class="col-lg-9">
                <div class="news-list">
                    @if (ViewBag.Novinky != null)
                    {
                        @foreach (var novinky in ViewBag.Novinky)
                        {
                            <div class="news-item d-flex align-items-start mb-4">
                                @if (novinky.IconPhoto != null && novinky.IconPhoto.Length > 0)
                                {
                                    <a asp-controller="Home" asp-action="ProductDetails" asp-route-id="@novinky.Id" class="me-3">
                                        @{
                                            var base64 = Convert.ToBase64String(novinky.IconPhoto);
                                            var imgSrc = "data:image/jpeg;base64," + base64;
                                            <img src="@imgSrc" class="rounded" alt="News Image">
                                        }
                                    </a>
                                }
                                <div>
                                    <span class="badge bg-secondary">@novinky.PostedDate.ToString("yyyy-MM-dd")</span>
                                    <h5 class="mt-2">@novinky.Title</h5>
                                    <p>@novinky.Comment</p>
                                    <a asp-controller="Home" asp-action="ProductDetails" asp-route-id="@novinky.Id" class="btn btn-info btn-sm">Číst více »</a>
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        <p>Nejsou žádné nové informace o nových produktech!</p>
                    }
                </div>
            </div>

            <!-- Правый блок с календарем -->
            <div class="col-lg-3">
                <div class="card p-3" style="width:340px;">
                    <h5 class="text-center">Vyberte období</h5>
                    <input type="text" id="news-calendar" class="form-control">
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Подключаем Flatpickr -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        flatpickr("#news-calendar", {
            inline: true,  // Календарь всегда открыт
            dateFormat: "Y-m-d",
            onChange: function (selectedDates, dateStr) {
                document.getElementById("frm-periodForm-period").value = dateStr;
                document.getElementById("frm-periodForm").submit();
            }
        });
    });
</script>